extends layout

block javascript
	script(src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js")
	script(src="http://cdn.sockjs.org/sockjs-0.3.min.js")
	script(src="http://cdnjs.cloudflare.com/ajax/libs/lodash.js/1.3.1/lodash.js")
	
	script(src="http://code.createjs.com/createjs-2013.05.14.min.js")
	
	script(src="../client/Loader.js")
	script(src="../client/ColorSubstitutionFilter.js")
	script(src="../client/ColorMatrix.js")
	script(src="../client/ColorMatrixFilter.js")
	script(src="../client/Config.js")
	// addons.js may change to be generated by server rather than a static file:
	script(src="../client/addons.js")
	script(src="../client/Avatar.js")
	script(src="../client/AvatarAssets.js")
	script(src="../client/DressingRoom.js")
	script(src="../client/AddonsList.js")
	script(src="../client/Comm.js")
	script(src="../client/main.js")
	
	script(type='text/javascript').
		var token = '#{token}';
		var session = '#{session}';
		
		// big global variable for remembering stuff 
		var g = {load:{}, dressing:{}, homeroom:{}, game:{}};
		
		// sissyfight namespace
		this.sf = this.sf||{};
				
		// createJS says they'll change the name in next release.  Meanwhile:
		createjs.Sprite = createjs.BitmapAnimation;

		sf.start = function(SockJS, auth) {
			var stage = new createjs.Stage("appCanvas");
			var main = new sf.Main();
			stage.addChild(main);
			main.start(SockJS, auth);
		}


		
block content
	h1 SiSSYFiGHT 2000&frac12;
	
	p: form(method='post',action='/user/logout')
		input(type='submit', value='log out')
			
	script(type='text/javascript').
		window.onload = function() {
			sf.start(SockJS, {token:token, session:session, endpoint:'/sox'});
		}
		
			
		
	style.
		/*	attempt to scale up canvas while preserving pixels - 
			fails to prevent blurring on firefox and chrome, but works on safari and ios 5 and 6 browser 
			https://developer.mozilla.org/en-US/docs/Web/CSS/image-rendering
		*/
		#appCanvas {   
			image-rendering:-webkit-optimize-contrast; 
			image-rendering:pixelated;  
			image-rendering:moz-crisp-edges; 
			image-rendering:-o-crisp-edges;    
			-ms-interpolation-mode: nearest-neighbor;
			
			image-rendering:optimizeSpeed;              /* Legal fallback                 */
			image-rendering:-moz-crisp-edges;           /* Firefox                        */
			image-rendering:crisp-edges;                /* CSS3 Proposed                  */
			}
		.doubleCanvas {
			width: 1056px;    
			height: 552px;  
		}
		.singleCanvas {
			width: 528;
			height: 276;
		}
		
	div#container
		canvas(id="appCanvas", class="doubleCanvas", width="528", height="276")
		
	